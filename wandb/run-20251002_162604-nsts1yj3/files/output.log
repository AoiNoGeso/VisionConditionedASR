
============================================================
Training Configuration
============================================================
Device: cuda:1
Batch size: 8
Learning rate: 0.0001
Num epochs: 10
Use wandb: True
============================================================

[Setup] Initializing model...
Some weights of Wav2Vec2ForCTC were not initialized from the model checkpoint at facebook/wav2vec2-base-960h and are newly initialized: ['wav2vec2.masked_spec_embed']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Some weights of Wav2Vec2ForCTC were not initialized from the model checkpoint at facebook/wav2vec2-base-960h and are newly initialized: ['wav2vec2.masked_spec_embed']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Using a slow image processor as `use_fast` is unset and a slow processor was saved with this model. `use_fast=True` will be the default behavior in v4.52, even if the model was saved with a slow processor. This will result in minor differences in outputs. You'll still be able to use a slow processor with `use_fast=False`.
[Model] Auto-detected vocab_size: 32

============================================================
Layer Freeze Configuration
============================================================
✓ Audio Encoder (Wav2Vec2):    FROZEN
✓ Vision Encoder (CLIP):       FROZEN
✓ Cross Attention:             Trainable
✓ Classifier (Linear):         Trainable (always)

============================================================
Parameter Statistics:
============================================================
Trainable parameters:  65,161,249 (26.56%)
Frozen parameters:     180,195,744 (73.44%)
Total parameters:      245,356,993
============================================================

[Setup] Creating dataloaders...

[Dataset] Loading data with file validation...

[Dataset] Loading statistics:
  Total items in JSON:     592012
  Missing image files:     0
  Missing audio files:     0
  Valid items loaded:      592012
  Success rate:            100.00%

[Dataset] Loading data with file validation...

[Dataset] Loading statistics:
  Total items in JSON:     24980
  Missing image files:     0
  Missing audio files:     0
  Valid items loaded:      24980
  Success rate:            100.00%

============================================================
Starting Training
============================================================


============================================================
Epoch 1/10 - Training
============================================================
Epoch 1 Train:   0%|                                                                                                                                         | 0/74002 [00:00<?, ?it/s]Traceback (most recent call last):

[Error] Exception at batch 0: 'CausalLMOutput' object has no attribute 'last_hidden_state'
  File "/home/kato/programs/VisionConditionedASR/src/train.py", line 262, in train_one_epoch
    logits = model(batch)  # [B, T, vocab_size]
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/src/model.py", line 316, in forward
    audio_features = self.audio_encoder(data)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/src/model.py", line 88, in forward
    audio_features = audio_outputs.last_hidden_state  # [B, seq_len, 768]
AttributeError: 'CausalLMOutput' object has no attribute 'last_hidden_state'
Epoch 1 Train:   0%|                                                                                                                              | 1/74002 [00:00<20:17:16,  1.01it/s]Traceback (most recent call last):

[Error] Exception at batch 1: 'CausalLMOutput' object has no attribute 'last_hidden_state'
  File "/home/kato/programs/VisionConditionedASR/src/train.py", line 262, in train_one_epoch
    logits = model(batch)  # [B, T, vocab_size]
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/src/model.py", line 316, in forward
    audio_features = self.audio_encoder(data)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/src/model.py", line 88, in forward
    audio_features = audio_outputs.last_hidden_state  # [B, seq_len, 768]
AttributeError: 'CausalLMOutput' object has no attribute 'last_hidden_state'

[Error] Exception at batch 2: 'CausalLMOutput' object has no attribute 'last_hidden_state'
Traceback (most recent call last):
  File "/home/kato/programs/VisionConditionedASR/src/train.py", line 262, in train_one_epoch
    logits = model(batch)  # [B, T, vocab_size]
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/src/model.py", line 316, in forward
    audio_features = self.audio_encoder(data)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/src/model.py", line 88, in forward
    audio_features = audio_outputs.last_hidden_state  # [B, seq_len, 768]
AttributeError: 'CausalLMOutput' object has no attribute 'last_hidden_state'

[Error] Exception at batch 3: 'CausalLMOutput' object has no attribute 'last_hidden_state'
Traceback (most recent call last):
  File "/home/kato/programs/VisionConditionedASR/src/train.py", line 262, in train_one_epoch
    logits = model(batch)  # [B, T, vocab_size]
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/src/model.py", line 316, in forward
    audio_features = self.audio_encoder(data)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/src/model.py", line 88, in forward
    audio_features = audio_outputs.last_hidden_state  # [B, seq_len, 768]
AttributeError: 'CausalLMOutput' object has no attribute 'last_hidden_state'
Epoch 1 Train:   0%|                                                                                                                               | 4/74002 [00:01<4:42:46,  4.36it/s]Traceback (most recent call last):

[Error] Exception at batch 4: 'CausalLMOutput' object has no attribute 'last_hidden_state'
  File "/home/kato/programs/VisionConditionedASR/src/train.py", line 262, in train_one_epoch
    logits = model(batch)  # [B, T, vocab_size]
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/src/model.py", line 316, in forward
    audio_features = self.audio_encoder(data)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/src/model.py", line 88, in forward
    audio_features = audio_outputs.last_hidden_state  # [B, seq_len, 768]
AttributeError: 'CausalLMOutput' object has no attribute 'last_hidden_state'

[Error] Exception at batch 5: 'CausalLMOutput' object has no attribute 'last_hidden_state'
Traceback (most recent call last):
  File "/home/kato/programs/VisionConditionedASR/src/train.py", line 262, in train_one_epoch
    logits = model(batch)  # [B, T, vocab_size]
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/src/model.py", line 316, in forward
    audio_features = self.audio_encoder(data)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/src/model.py", line 88, in forward
    audio_features = audio_outputs.last_hidden_state  # [B, seq_len, 768]
AttributeError: 'CausalLMOutput' object has no attribute 'last_hidden_state'
Epoch 1 Train:   0%|                                                                                                                               | 6/74002 [00:01<3:15:01,  6.32it/s]Traceback (most recent call last):

[Error] Exception at batch 6: 'CausalLMOutput' object has no attribute 'last_hidden_state'
  File "/home/kato/programs/VisionConditionedASR/src/train.py", line 262, in train_one_epoch
    logits = model(batch)  # [B, T, vocab_size]
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/src/model.py", line 316, in forward
    audio_features = self.audio_encoder(data)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/src/model.py", line 88, in forward
    audio_features = audio_outputs.last_hidden_state  # [B, seq_len, 768]
AttributeError: 'CausalLMOutput' object has no attribute 'last_hidden_state'

[Error] Exception at batch 7: 'CausalLMOutput' object has no attribute 'last_hidden_state'
Traceback (most recent call last):
  File "/home/kato/programs/VisionConditionedASR/src/train.py", line 262, in train_one_epoch
    logits = model(batch)  # [B, T, vocab_size]
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/src/model.py", line 316, in forward
    audio_features = self.audio_encoder(data)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/src/model.py", line 88, in forward
    audio_features = audio_outputs.last_hidden_state  # [B, seq_len, 768]
AttributeError: 'CausalLMOutput' object has no attribute 'last_hidden_state'
Epoch 1 Train:   0%|                                                                                                                               | 8/74002 [00:01<2:24:27,  8.54it/s]Traceback (most recent call last):

[Error] Exception at batch 8: 'CausalLMOutput' object has no attribute 'last_hidden_state'
  File "/home/kato/programs/VisionConditionedASR/src/train.py", line 262, in train_one_epoch
    logits = model(batch)  # [B, T, vocab_size]
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/src/model.py", line 316, in forward
    audio_features = self.audio_encoder(data)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/src/model.py", line 88, in forward
    audio_features = audio_outputs.last_hidden_state  # [B, seq_len, 768]
AttributeError: 'CausalLMOutput' object has no attribute 'last_hidden_state'

[Error] Exception at batch 9: 'CausalLMOutput' object has no attribute 'last_hidden_state'
Traceback (most recent call last):
  File "/home/kato/programs/VisionConditionedASR/src/train.py", line 262, in train_one_epoch
    logits = model(batch)  # [B, T, vocab_size]
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/src/model.py", line 316, in forward
    audio_features = self.audio_encoder(data)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/src/model.py", line 88, in forward
    audio_features = audio_outputs.last_hidden_state  # [B, seq_len, 768]
AttributeError: 'CausalLMOutput' object has no attribute 'last_hidden_state'
Epoch 1 Train:   0%|                                                                                                                              | 10/74002 [00:01<2:03:20, 10.00it/s]Traceback (most recent call last):

[Error] Exception at batch 10: 'CausalLMOutput' object has no attribute 'last_hidden_state'
  File "/home/kato/programs/VisionConditionedASR/src/train.py", line 262, in train_one_epoch
    logits = model(batch)  # [B, T, vocab_size]
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/src/model.py", line 316, in forward
    audio_features = self.audio_encoder(data)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/src/model.py", line 88, in forward
    audio_features = audio_outputs.last_hidden_state  # [B, seq_len, 768]
AttributeError: 'CausalLMOutput' object has no attribute 'last_hidden_state'

[Error] Exception at batch 11: 'CausalLMOutput' object has no attribute 'last_hidden_state'
Traceback (most recent call last):
  File "/home/kato/programs/VisionConditionedASR/src/train.py", line 262, in train_one_epoch
    logits = model(batch)  # [B, T, vocab_size]
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/src/model.py", line 316, in forward
    audio_features = self.audio_encoder(data)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/src/model.py", line 88, in forward
    audio_features = audio_outputs.last_hidden_state  # [B, seq_len, 768]
AttributeError: 'CausalLMOutput' object has no attribute 'last_hidden_state'
Epoch 1 Train:   0%|                                                                                                                              | 12/74002 [00:01<1:51:49, 11.03it/s]Traceback (most recent call last):

[Error] Exception at batch 12: 'CausalLMOutput' object has no attribute 'last_hidden_state'
  File "/home/kato/programs/VisionConditionedASR/src/train.py", line 262, in train_one_epoch
    logits = model(batch)  # [B, T, vocab_size]
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/src/model.py", line 316, in forward
    audio_features = self.audio_encoder(data)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/src/model.py", line 88, in forward
    audio_features = audio_outputs.last_hidden_state  # [B, seq_len, 768]
AttributeError: 'CausalLMOutput' object has no attribute 'last_hidden_state'

[Error] Exception at batch 13: 'CausalLMOutput' object has no attribute 'last_hidden_state'
Traceback (most recent call last):
  File "/home/kato/programs/VisionConditionedASR/src/train.py", line 262, in train_one_epoch
    logits = model(batch)  # [B, T, vocab_size]
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/src/model.py", line 316, in forward
    audio_features = self.audio_encoder(data)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/src/model.py", line 88, in forward
    audio_features = audio_outputs.last_hidden_state  # [B, seq_len, 768]
AttributeError: 'CausalLMOutput' object has no attribute 'last_hidden_state'
Epoch 1 Train:   0%|                                                                                                                              | 14/74002 [00:01<1:41:14, 12.18it/s]Traceback (most recent call last):

[Error] Exception at batch 14: 'CausalLMOutput' object has no attribute 'last_hidden_state'
  File "/home/kato/programs/VisionConditionedASR/src/train.py", line 262, in train_one_epoch
    logits = model(batch)  # [B, T, vocab_size]
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/src/model.py", line 316, in forward
    audio_features = self.audio_encoder(data)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/src/model.py", line 88, in forward
    audio_features = audio_outputs.last_hidden_state  # [B, seq_len, 768]
AttributeError: 'CausalLMOutput' object has no attribute 'last_hidden_state'

[Error] Exception at batch 15: 'CausalLMOutput' object has no attribute 'last_hidden_state'
Traceback (most recent call last):
  File "/home/kato/programs/VisionConditionedASR/src/train.py", line 262, in train_one_epoch
    logits = model(batch)  # [B, T, vocab_size]
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/src/model.py", line 316, in forward
    audio_features = self.audio_encoder(data)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/src/model.py", line 88, in forward
    audio_features = audio_outputs.last_hidden_state  # [B, seq_len, 768]
AttributeError: 'CausalLMOutput' object has no attribute 'last_hidden_state'
Epoch 1 Train:   0%|                                                                                                                              | 16/74002 [00:01<1:35:22, 12.93it/s]Traceback (most recent call last):

[Error] Exception at batch 16: 'CausalLMOutput' object has no attribute 'last_hidden_state'
  File "/home/kato/programs/VisionConditionedASR/src/train.py", line 262, in train_one_epoch
    logits = model(batch)  # [B, T, vocab_size]
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/src/model.py", line 316, in forward
    audio_features = self.audio_encoder(data)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/src/model.py", line 88, in forward
    audio_features = audio_outputs.last_hidden_state  # [B, seq_len, 768]
AttributeError: 'CausalLMOutput' object has no attribute 'last_hidden_state'

[Error] Exception at batch 17: 'CausalLMOutput' object has no attribute 'last_hidden_state'
Traceback (most recent call last):
  File "/home/kato/programs/VisionConditionedASR/src/train.py", line 262, in train_one_epoch
    logits = model(batch)  # [B, T, vocab_size]
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/src/model.py", line 316, in forward
    audio_features = self.audio_encoder(data)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/src/model.py", line 88, in forward
    audio_features = audio_outputs.last_hidden_state  # [B, seq_len, 768]
AttributeError: 'CausalLMOutput' object has no attribute 'last_hidden_state'
Epoch 1 Train:   0%|                                                                                                                              | 18/74002 [00:02<1:27:24, 14.11it/s]Traceback (most recent call last):

[Error] Exception at batch 18: 'CausalLMOutput' object has no attribute 'last_hidden_state'
  File "/home/kato/programs/VisionConditionedASR/src/train.py", line 262, in train_one_epoch
    logits = model(batch)  # [B, T, vocab_size]
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/src/model.py", line 316, in forward
    audio_features = self.audio_encoder(data)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/src/model.py", line 88, in forward
    audio_features = audio_outputs.last_hidden_state  # [B, seq_len, 768]
AttributeError: 'CausalLMOutput' object has no attribute 'last_hidden_state'

[Error] Exception at batch 19: 'CausalLMOutput' object has no attribute 'last_hidden_state'
Traceback (most recent call last):
  File "/home/kato/programs/VisionConditionedASR/src/train.py", line 262, in train_one_epoch
    logits = model(batch)  # [B, T, vocab_size]
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/src/model.py", line 316, in forward
    audio_features = self.audio_encoder(data)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/src/model.py", line 88, in forward
    audio_features = audio_outputs.last_hidden_state  # [B, seq_len, 768]
AttributeError: 'CausalLMOutput' object has no attribute 'last_hidden_state'
Epoch 1 Train:   0%|                                                                                                                              | 20/74002 [00:02<2:22:48,  8.63it/s]
Traceback (most recent call last):
  File "/home/kato/programs/VisionConditionedASR/src/train.py", line 596, in <module>
    main()
  File "/home/kato/programs/VisionConditionedASR/src/train.py", line 560, in main
    train_loss = train_one_epoch(
  File "/home/kato/programs/VisionConditionedASR/src/train.py", line 262, in train_one_epoch
    logits = model(batch)  # [B, T, vocab_size]
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/src/model.py", line 316, in forward
    audio_features = self.audio_encoder(data)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/src/model.py", line 83, in forward
    audio_outputs = self.model(
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/transformers/models/wav2vec2/modeling_wav2vec2.py", line 1867, in forward
    outputs = self.wav2vec2(
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/transformers/models/wav2vec2/modeling_wav2vec2.py", line 1463, in forward
    hidden_states = self._mask_hidden_states(
  File "/home/kato/programs/VisionConditionedASR/lib/python3.10/site-packages/transformers/models/wav2vec2/modeling_wav2vec2.py", line 1415, in _mask_hidden_states
    mask_time_indices = torch.tensor(mask_time_indices, device=hidden_states.device, dtype=torch.bool)
KeyboardInterrupt
